---
title: "Simulations for all-optical diagnostic ultrasound (BSc project)"
excerpt: "Photoacoustic modelling and simulations from first-principles"
header:
  image: files/portfolio/chamber.png
  teaser: files/portfolio/bsc_chamber.png
sidebar:
  - title: "Role"
    image: /files/opt/imperial-600.png
    image_alt: "Imperial College London logo"
    text: "Student researcher"

  - title: "Timeframe"
  - text: "Jan-Apr 2022"

  - title: "Supervisor"
    text: "[Dr Chris Rowlands](https://profiles.imperial.ac.uk/c.rowlands) at Imperial College London"
  - title: "Responsibilities"
    text: "Driving and delivering the project, along with project partner Yuji Go."

mathjax: true
---

## Our Imperial Bsc project

Having developed an interest in interdisciplinary research, I did a project with with Bioengineering department. This is a computational-based project scoping out the ability to generate arbitrary wavefronts using an all-optical ultrasound transducer.

### Motivation

### What is ultrasound?

Ultrasound waves are acoustic disturbances of pressure above a frequency of 20 kHz.
Diagnostic ultrasound uses these sound waves to visualise body structure for inspection or
to search for abnormalities. Common applications in humans include prenatal ultrasound
and echocardiograms.
Ultrasound is a promising modality for realising high throughput and realtime whole-
body diagnostic imaging. Some reasons include low cost and that it uses non-ionising
radiation, making it suitable long time monitoring.

The foundation of ultrasound imaging is the time-of-flight principle. An acoustic pulse is
emitted by a transducer and is directed into the object of interest. The wave interacts
with the structure of the object and produces strong reflections at sudden impedance
changes. The return echoes allow calculation of object depths, given the speed of sound in
the medium. Imaging in multiple dimensions require sending multiple pulses in different
directions. These pulses can be steered by mechanically translating the transducer and
focused by using a curved transducer surface, though the same can be done with arrays.
Individual transducer elements can be delayed and weighted electronically for beamforming
using phased-array, which allow for high frame rates.

There is potential for all-optical ultrasound to make whole-body imaging more affordable, safer and have higher resolution. We present results from computer simulations done with the k-Wave toolkit to study the phased-array performance for an all-optical ultrasound system. This proposed implementation uses the superposition of signals from four electro- optic modulator and spatial light modulator pairs to generate a pulsed acoustic wave via the thermoelastic effect. The phased-array effect is limited because time delays are limited to within 1 period of the central acoustic pulse frequency.

## What I did

I studied the mathematics of ultrasound and subsequently set up the physics simulation in MATLAB to study the beam shape.

![Ultrasound setup](/files/ultrasound/setup.png)

To determine whether these phased-wrapped waves could still be used for imaging, the resolution was investigated by measuring beam widths and insonifying three phantoms in 2D using steered and focused waves.

![alt text](/files/ultrasound/steered.png)

An image can be generated by measuring the reflected waves using the same simulated transducer. I collected this data and analysed the images quantitatively using various metrics.

Contrast Ratio

$$CR = \frac{A_\textsf{out}-A_\text{in}}{A_\text{out}+A_\text{in}}$$

Contrast-to-noise ratio

$$CNR = \frac{|A_\textsf{out}-A_\text{in}|}{\sqrt{\sigma_\text{out}^2 + \sigma_\text{in}^2}}$$

where $$A_\textsf{out}$$, $$A_\textsf{in}$$ are the average pixel intensities outside and inside the ROI respectively and $$\sigma_\text{in}^2$$ and $$\sigma_\text{out}^2$$ denote the standard deviations of the signals within and outside the ROI.

![Comparison](/files/ultrasound/comparison.png)

Results indicate that the axial and lateral resolution of the system decreases rapidly around $$20^\circ$$ steering. The lateral width of the main lobe doubled at 45◦steering using the -6 dB width metric, while the axial width doubles at $$25^\circ$$.

![alt text](/files/ultrasound/phantoms.png)

Three phantoms were insonified to generate B-mode images in simulation. An analysis
of the CR and CNR of anechoic chambers suggest that the performance of the wrapped
wave is around 40−80 % of the unwrapped wave. Off-axis features were significantly warped
or could not be visualised in using the phase wrapped waves.

Excitingly, there is evidence that this current implementation maintains image quality at small
steering angles!

## Skills developed

**Physics**: understanding of ultrasound concepts (A-scan, B-scan), bandwidth, signal quality metrics (signal to noise ratio, contrast ratio).

**Simulation**: Learnt the [k-Wave](http://www.k-wave.org/) software in MATLAB.

**Software**: ImageJ for image analysis.

## Related work

Glenn A. Howe, Meng-Xing Tang, and Christopher J. Rowlands, "Tailored photoacoustic apertures with superimposed optical holograms," [Biomed. Opt. Express 14](https://opg.optica.org/boe/fulltext.cfm?uri=boe-14-12-6361&id=542535), 6361-6380 (2023)
